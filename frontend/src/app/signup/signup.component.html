<div class="signup-container">
  <div class="signup-card">
    <!-- <div class="progress-indicator">
      <div class="progress-bar">
        <div
          class="progress"
          [style.width]="(currentStep / 3) * 100 + '%'"
        ></div>
      </div>
      <div class="steps">
        <div
          class="step"
          [class.active]="currentStep >= 1"
          [class.completed]="currentStep > 1"
        >
          <div class="step-icon">1</div>
          <span class="step-label">Basic Details</span>
        </div>
        <div
          class="step"
          [class.active]="currentStep >= 2"
          [class.completed]="currentStep > 2"
        >
          <div class="step-icon">2</div>
          <span class="step-label">Membership</span>
        </div>
        <div class="step" [class.active]="currentStep >= 3">
          <div class="step-icon">3</div>
          <span class="step-label">Complete</span>
        </div>
      </div>
    </div> -->

    <app-progress-indicator
      [currentStep]="currentStep"
      [totalSteps]="3"
    ></app-progress-indicator>
    
    <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">
      <div
        *ngIf="currentStep === 1"
        formGroupName="basicDetails"
        class="form-step"
      >
        <h2 class="form-title">Basic Details</h2>
        <p class="form-subtitle">Please fill in your personal information</p>

        <div class="form-grid">
          <div class="form-group">
            <label>Username</label>
            <div class="input-container">
              <i class="fas fa-user input-icon"></i>
              <input
                type="text"
                formControlName="username"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'username')"
                placeholder="Enter username"
              />
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'username')">
              <span *ngIf="basicDetails.get('username')?.errors?.['required']"
                >Username is required</span
              >
              <span *ngIf="basicDetails.get('username')?.errors?.['minlength']"
                >Username must be at least 3 characters</span
              >
            </div>
          </div>

          <div class="form-group">
            <label>Email</label>
            <div class="input-container">
              <i class="fas fa-envelope input-icon"></i>
              <input
                type="email"
                formControlName="email"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'email')"
                placeholder="Enter email"
              />
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'email')">
              <span *ngIf="basicDetails.get('email')?.errors?.['required']"
                >Email is required</span
              >
              <span *ngIf="basicDetails.get('email')?.errors?.['email']"
                >Please enter a valid email</span
              >
            </div>
          </div>

          <div class="form-group">
            <label>Password</label>
            <div class="input-container">
              <i class="fas fa-lock input-icon"></i>
              <input
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'password')"
                placeholder="Enter your password"
              />
              <i
                class="fas password-toggle"
                [class.fa-eye]="!showPassword"
                [class.fa-eye-slash]="showPassword"
                (click)="togglePasswordVisibility()"
              ></i>
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'password')">
              <span *ngIf="basicDetails.get('password')?.errors?.['required']"
                >Password is required</span
              >
              <span *ngIf="basicDetails.get('password')?.errors?.['pattern']"
                >Please enter a valid password :
                <ul>
                  <li>At least 6 characters.</li>
                  <li>Contains at least one lowercase letter.</li>
                  <li>Contains at least one uppercase letter.</li>

                  <li>Contains at least one digit.</li>
                </ul></span
              >
            </div>
          </div>

          <div class="form-group">
            <label>Phone</label>
            <div class="input-container">
              <i class="fas fa-phone input-icon"></i>
              <input
                type="tel"
                formControlName="phone"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'phone')"
                placeholder="Enter phone number"
              />
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'phone')">
              <span *ngIf="basicDetails.get('phone')?.errors?.['required']"
                >Phone number is required</span
              >
              <span *ngIf="basicDetails.get('phone')?.errors?.['pattern']"
                >Please enter a valid 8-digit phone number</span
              >
            </div>
          </div>

          <div class="form-group">
            <label>Gender</label>
            <div class="input-container">
              <i class="fas fa-venus-mars input-icon"></i>
              <select
                formControlName="gender"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'gender')"
              >
                <option value="">Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'gender')">
              Please select a gender
            </div>
          </div>

          <div class="form-group">
            <label>Age</label>
            <div class="input-container">
              <i class="fas fa-birthday-cake input-icon"></i>
              <input
                type="number"
                formControlName="age"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'age')"
                placeholder="Enter age"
              />
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'age')">
              <span *ngIf="basicDetails.get('age')?.errors?.['required']"
                >Age is required</span
              >
              <span
                *ngIf="basicDetails.get('age')?.errors?.['min'] || basicDetails.get('age')?.errors?.['max']"
              >
                Age must be between 16 and 100
              </span>
            </div>
          </div>

          <div class="form-group">
            <label>Height (cm)</label>
            <div class="input-container">
              <i class="fas fa-ruler-vertical input-icon"></i>
              <input
                type="number"
                formControlName="height"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'height')"
                placeholder="Enter height"
              />
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'height')">
              <span *ngIf="basicDetails.get('height')?.errors?.['required']"
                >Height is required</span
              >
              <span
                *ngIf="basicDetails.get('height')?.errors?.['min'] || basicDetails.get('height')?.errors?.['max']"
              >
                Height must be between 100 and 250 cm
              </span>
            </div>
          </div>

          <div class="form-group">
            <label>Weight (kg)</label>
            <div class="input-container">
              <i class="fas fa-weight input-icon"></i>
              <input
                type="number"
                formControlName="weight"
                class="form-control"
                [class.is-invalid]="isFieldInvalid(basicDetails, 'weight')"
                placeholder="Enter weight"
              />
            </div>
            <div class="error" *ngIf="isFieldInvalid(basicDetails, 'weight')">
              <span *ngIf="basicDetails.get('weight')?.errors?.['required']"
                >Weight is required</span
              >
              <span
                *ngIf="basicDetails.get('weight')?.errors?.['min'] || basicDetails.get('weight')?.errors?.['max']"
              >
                Weight must be between 30 and 300 kg
              </span>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" (click)="nextStep()" class="btn btn-primary">
            <span>Next Step</span>
            <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>

      <div
        *ngIf="currentStep === 2"
        formGroupName="membershipDetails"
        class="form-step"
      >
        <h2 class="form-title">Membership Details</h2>
        <p class="form-subtitle">Choose your fitness journey</p>

        <div class="goals-grid">
          <div
            class="goal-card"
            *ngFor="let goal of goals"
            [class.selected]="membershipDetails.get('goal')?.value.includes(goal)"
            (click)="selectGoal(goal)"
          >
            <div class="goal-icon">
              <i [class]="getGoalIcon(goal)"></i>
            </div>
            <h3>{{ goal }}</h3>
            <p>{{ getGoalDescription(goal) }}</p>
          </div>
        </div>

        <div
          class="error goal-error"
          *ngIf="isFieldInvalid(membershipDetails, 'goal')"
        >
          Please select your fitness goal
        </div>

        <div class="form-actions">
          <button
            type="button"
            (click)="previousStep()"
            class="btn btn-secondary"
          >
            <i class="fas fa-arrow-left"></i>
            <span>Previous</span>
          </button>
          <button type="submit" class="btn btn-primary">
            <span>Submit Info</span>
            <i class="fas fa-check"></i>
          </button>
        </div>
      </div>

      <div *ngIf="currentStep === 3" class="form-step thank-you">
        <div class="success-animation">
          <i class="fas fa-check-circle"></i>
        </div>
        <h2 class="form-title">Thank You!</h2>
        <p class="success-message">
          Your registration has been completed successfully.
        </p>
        <p class="welcome-message">Welcome to our fitness family!</p>
        <button type="button" (click)="exit()" class="btn btn-primary">
          <span>Get Started</span>
          <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </form>
  </div>
</div>
